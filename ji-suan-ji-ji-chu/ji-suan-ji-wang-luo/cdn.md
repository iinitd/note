# CDN

## 过程

1.用户在浏览器输入url 2.浏览器向DNS服务器发起域名解析 3.因为我们接入了CDN，所以DNS服务器会将域名的解析权交给CND专用的DNS服务器 4.CND专用的DNS服务器将CDN的负载均衡设备IP返回给用户 5.用户根据ip地址访问CDN的负载均衡设备IP 6.CDN的负载均衡设备 为用户挑选一台最合适的CDN缓存服务器，把这台CDN缓存服务器的ip发给用户 7.用户根据ip地址访问这台CDN缓存服务器 8.这台CDN缓存服务器响应用户的请求，如果有资源，就把资源返回给用户；如果没有资源，就向它的上一级CDN缓存服务器发送请求，直到追溯哦到网站的源服务器，将内容拉取到本地

## 优化

资源调度：CDN会根据用户接入网络的ip寻找距离用户最优路径的服务器。调度的方式主要有DNS调度、http 302调度、使用 HTTP 进行的 DNS 调度（多用于移动端）； 缓存策略和数据检索：CDN服务器使用高效的算法和数据结构，快速的检索资源和更新读取缓存； 网络优化：从OSI七层模型进行优化，达到网络优化的目的。 L1物理层：硬件设备升级提高速度 L2数据链路层：寻找更快的网络节点、确保 Lastmile 尽量短 L3路由层：路径优化，寻找两点间最优路径 L4传输层：协议TCP优化，保持长连接、TCP快速打开 L7应用层：静态资源压缩、请求合并

把静态资源和主页面置于不同的域名下，就可以完美地避免请求中携带不必要的 Cookie。

